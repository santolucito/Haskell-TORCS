\section{Introduction}


We use automata to structure the combination of multiple neural networks.
Recurrent Neural Networks have been shown to correspond in computational (classification) power to deterministic finite automata~\cite{tino1998finite}.
While previous work had provided a translation from RNNs to DFAs, we show that this space can be seen as a spectrum.
By building systems that exist in between an RNN and a DFA we can gain the scalable power of RNN learning, but use DFAs at a high level to provide formal guarantees on the behavior of the system.

These synthesized controllers have strong formal guarantees, but were not competitive in performance with those built with machine learning techniques. We are now combining the two approaches to leverage the power of neural networks, as well as the safety properties of formal synthesis.

\subsection{Machine Learning for CPS}

Neural networks are used in building systems of autonomous vehicles, in both components such as vision systems, as well as top-level controllers that drive the car down the road.

End to end learning has been implemented previously in autonomous vehicles by Nvidia where a monolithic convolutional neural network was trained to map raw pixels from cameras to steering commands ~\cite{parallelforall}. This approach was shown to be successful in both simulation and real world tests.

Other autonomous car developers such as Drive.ai have used segmented deep learning neural networks to control their vehicles ~\cite{}. These researchers argue that incorrect decisions made by an end-to-end system can be difficult to correct since the selection making process of these algorithms cannot be intuitively understood. Techniques such as blacking out portions of camera images to select only the sections are used by the researchers to control the input the algorithm receives. 


Previous work has combined multiple smaller neural networks to create systems with better properties than monolithic learners~\cite{masoudnia2014mixture,baldacchino2016variational}.
We are the first to propose using Mealy Machines as a combination framework for neural networks.

\subsection{Legibility}

As demonstrated in~\cite{DBLP:journals/corr/SzegedyZSBEGF13}, neural networks can be unreliable in the presence of small perturbations of the input.
As an example, with the manipulation of just a few pixels, a neural network can be fooled into thinking a stop sign is a speed limit sign.
These perturbations can be the result of random noise, or adversarial actors who aim to disrupt the safe behavior of the system.

In fact, in autonomous vehicles, further attacks are possible when the attacker has direct access to hardware.
As demonstrated in~\cite{DBLP:journals/iacr/Shoukry0TS15}, by non-intrusively attaching a small device in the wheel well of a car, the sensors that track the speed of the wheels can be completely controlled by an attacker.
Under unreliable sensor data, autonomous vehicles must continue to behave, as best as is possible, in a safe manner.
However, when using monolithic controllers, such as top-level neural networks for driving control, safely handling anomalous input remains a challenge.

We identify our contributions as follows:
\begin{enumerate}
\item A method of compositional construction of cyber-physical systems controllers with neural network components.
\item Using reactive program synthesis to build, and provide safety guarantees, for such systems.
\item An evaluation of this approach in the vehicle simulator TORCS.
\end{enumerate}


